# Notes API

Простое REST API для работы с заметками.

Проект реализован как учебное мини-приложение с чётким разделением слоёв (routes → controllers → services → models) и централизованной валидацией и обработкой ошибок.

---

## Общие правила

- API принимает и возвращает **JSON**
- Все даты передаются в формате **ISO string**
- Все ошибки возвращаются в формате:

```json
{
  "error": "message"
}
```

---

## POST `/notes`

### Назначение

Создание новой заметки.

### Тело запроса

```json
{
  "title": "string",
  "content": "string"
}
```

### Валидация

- `title` — **обязательное поле**

  - только буквы и цифры (латиница + кириллица)
  - минимум 1 символ
  - максимум 10 символов

- `content` — **обязательное поле**

  - только буквы и цифры (латиница + кириллица)
  - минимум 1 символ
  - максимум 10 символов

### Поведение

- `id` генерируется на сервере
- `createdAt` и `updatedAt` устанавливаются автоматически

### Ответ

**201 Created**

```json
{
  "id": "uuid",
  "title": "string",
  "content": "string",
  "createdAt": "ISO string",
  "updatedAt": "ISO string"
}
```

### Ошибки

- `400` — ошибка валидации
- `500` — внутренняя ошибка сервера

---

## GET `/notes`

### Назначение

Получить список всех заметок.

### Ответ

**200 OK**

```json
[
  {
    "id": "uuid",
    "title": "string",
    "content": "string",
    "createdAt": "ISO string",
    "updatedAt": "ISO string"
  }
]
```

---

## GET `/notes/:id`

### Назначение

Получить заметку по идентификатору.

### Ответ

**200 OK**

```json
{
  "id": "uuid",
  "title": "string",
  "content": "string",
  "createdAt": "ISO string",
  "updatedAt": "ISO string"
}
```

### Ошибки

- `404` — заметка не найдена

---

## PUT `/notes/:id`

### Назначение

Частичное обновление существующей заметки.

> PUT используется с **PATCH-поведением**.

### Тело запроса

```json
{
  "title": "string (optional)",
  "content": "string (optional)"
}
```

### Валидация

- Можно передать **одно или оба поля**
- Нельзя передать пустой объект `{}`
- Если поле **не передано**, оно **не изменяется**
- Если поле передано, оно валидируется по тем же правилам, что и при `POST /notes`

### Поведение

- Обновляются только переданные поля
- `updatedAt` обновляется всегда
- Остальные поля остаются без изменений

### Ответ

**200 OK**

```json
{
  "id": "uuid",
  "title": "string",
  "content": "string",
  "createdAt": "ISO string",
  "updatedAt": "ISO string"
}
```

### Ошибки

- `400` — ошибка валидации
- `404` — заметка не найдена

---

## DELETE `/notes/:id`

### Назначение

Удалить заметку.

### Ответ

**204 No Content**

### Ошибки

- `404` — заметка не найдена

---

## Архитектурные решения

- `PUT` реализован как частичное обновление (PATCH-поведение)
- `PATCH` не используется, но может быть добавлен без изменения логики
- Валидация входных данных реализована через **Joi middleware**
- Бизнес-логика не затирает отсутствующие поля при обновлении
- Обработка ошибок централизована через кастомные ошибки и `errorHandler`

---

## Гарантии контракта

- Отсутствующее поле при обновлении **никогда не обнуляется**
- Некорректные данные **не доходят до сервиса**
- API не зависит от способа хранения данных (файл / БД)

---

## Статус проекта

Учебный проект. Подготовлен к расширению:

- подключение базы данных
- авторизация
- дополнительные сущности
